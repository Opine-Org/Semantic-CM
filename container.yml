imports:
    - 'src/Manager/container.yml'
    - 'vendor/opine/collection/package-container.yml'
    - 'vendor/opine/route/package-container.yml'
    - 'vendor/opine/form/package-container.yml'

services:
    yamlSlow:
        class:     'Symfony\Component\Yaml\Yaml'
    containerCache:
        class:     'Opine\Container\Cache'
        arguments: ['%root%', '@container', '@bundleRoute', '@cache']
    build:
        class:     'Opine\Build'
        arguments: ['%root%', '@pubSubBuild', '@collectionModel', '@helperRoute', '@formRoute', '@configRoute', '@bundleRoute', '@fieldRoute', '@filter', '@cache', '@search', '@authentication', '@route', '@containerCache']
    pubSubBuild:
        class:     'Opine\PubSubBuild'
        arguments: ['%root%', '@yamlSlow', '@bundleRoute']
    topic:
        class:     'Opine\Topic'
        arguments: ['@container']
    separation:
        class:     'Opine\Separation'
        arguments: ['%root%', '@handlebars', '@cache', '@config', '@yamlSlow', '@route']
    field:
        class:     'Opine\Field'
        arguments: ['%root%', '@container']
    fieldRoute:
        class:     'Opine\FieldRoute'
    authentication:
        class:     'Opine\Authentication'
        arguments: ['%root%', '@db', '@config', '@yamlSlow', '@route', '@cache', '@authenticationCollector']
    authenticationCollector:
        class:     'FastRoute\RouteCollector'
        arguments: ['@authFastrouteParser', '@authFastrouteGenerator']
    authFastrouteParser:
        class:     'FastRoute\RouteParser\Std'
    authFastrouteGenerator:
        class:     'FastRoute\DataGenerator\GroupCountBased'
    helperRoute:
        class:     'Opine\HelperRoute'
        arguments: ['%root%', '@handlebars', '@bundleRoute']
    configRoute:
        class:     'Opine\ConfigRoute'
        arguments: ['@config', '@cache']
    filter:
        class:     'Opine\Filter'
        arguments: []
    cache:
        class:     'Opine\Cache'
    handlebars:
        class:     'Handlebars\Handlebars'
    config:
        class:     'Opine\Config'
        arguments: ['%root%', '@cache']
    db:
        class:     'Opine\Mongo'
        arguments: ['@config', '@topic']
    dbmigration:
        class:     'Opine\Migration'
        arguments: ['@db']
    post:
        class:     'Opine\HTTPPost'
    person:
        class:     'Opine\Person'
        arguments: ['@db', '@config']
    errors:
        class:     'Opine\Errors'
        arguments: ['@config', '@topic', '@separation']
    queueGateway: 
        class:     'Pheanstalk_Pheanstalk'
        arguments: ['127.0.0.1']
    queue:
        class:     'Opine\Queue'
        arguments: ['%root%', '@queueGateway']
    worker:
        class:     'Opine\Worker'
        arguments: ['%root%', '@queueGateway', '@topic']
    searchGateway:
        class:     'Elasticsearch\Client'
    search:
        class:     'Opine\Search'
        arguments: ['%root%', '@searchGateway']
    bundleRoute:
        class:     'Opine\BundleRoute'
        arguments: ['%root%', '@container']
    uploadwrapper:
        class:     'Opine\UploadWrapper'
        arguments: ['%root%']
    slugify:
        class:     'Cocur\Slugify\Slugify'
    imageResizer:
        class:     'Opine\ImageResizer'
        arguments: ['@route']